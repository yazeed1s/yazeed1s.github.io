<!doctype html>
<html lang="en">

<head>
<meta charset="UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="A simple way to embed multiple boolean conditions in a single integer." />
<meta
    name="keywords"
    content="yazeed, blog, alharthi, yaz, yazeed1s"
/>
<link rel="canonical" href="https://yazeed1s.github.io/posts/bit-flags/" />

<title>Using Bit Flags to Pack Multiple States Efficiently | Yazeed&#x27;s Blog</title>
<meta property="og:site_name" content="Yazeed&#x27;s Blog" />
<meta property="og:title" content="Using Bit Flags to Pack Multiple States Efficiently | Yazeed&#x27;s Blog" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://yazeed1s.github.io/posts/bit-flags/" />
<meta property="og:description" content="A simple way to embed multiple boolean conditions in a single integer." />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Using Bit Flags to Pack Multiple States Efficiently" />
<meta name="twitter:description" content="A simple way to embed multiple boolean conditions in a single integer." />

    <link rel="icon" href="&#x2F;favicon.ico" />
    
    <link rel="stylesheet" href="https://yazeed1s.github.io/font.css" />
    <link rel="stylesheet" href="https://yazeed1s.github.io/css/base.css" />

                  
    <style>
        :root {
            --nav-basis: 25

            %;

            --light-bg: #eae6deff

            ;

            --light-text: #1a1410

            ;

            --light-text-muted: #1a1410

            ;

            --light-accent: #9E4440

            ;

            --light-accent-hover: #7A3533

            ;

            --light-code-bg: #e1ded6ff

            ;

            --light-border: #abaaaaff

            ;

            --dark-bg: #303132

            ;

            --dark-text: #bebbb9ff

            ;

            --dark-text-muted: #d5d2cf

            ;

            --dark-accent: #e57665

            ;

            --dark-accent-hover: #888885

            ;

            --dark-code-bg: #282829

            ;

            --dark-border: #524f4c

            ;
        }
    </style>
    <meta name="theme-color" id="tc" />
    <script>
        (function () {
            var m = matchMedia("(prefers-color-scheme:dark)"),
                t = localStorage.theme || (m.matches ? "dark" : "light"),
                h = document.documentElement,
                c = document.getElementById("tc");
            h.className = t;
            function u() {
                c.content = getComputedStyle(h).getPropertyValue("--tc");
            }
            u();
            window.T = function () {
                t = t === "dark" ? "light" : "dark";
                localStorage.theme = t;
                h.className = t;
                u();
            };
        })();
    </script>
    
</head>

<body>
    <a href="#main" class="skip-link">Skip to content</a>
    <svg xmlns="http://www.w3.org/2000/svg" style="display:none"><symbol id="light" viewBox="0 0 32 32"><rect x="15" y="2" width="2" height="5"/><rect x="21.6675" y="6.8536" width="4.958" height="1.9998" transform="translate(1.5191 19.3744) rotate(-45)"/><rect x="25" y="15" width="5" height="2"/><rect x="23.1466" y="21.6675" width="1.9998" height="4.958" transform="translate(-10.0018 24.1465) rotate(-45)"/><rect x="15" y="25" width="2" height="5"/><rect x="5.3745" y="23.1466" width="4.958" height="1.9998" transform="translate(-14.7739 12.6256) rotate(-45)"/><rect x="2" y="15" width="5" height="2"/><rect x="6.8536" y="5.3745" width="1.9998" height="4.958" transform="translate(-3.253 7.8535) rotate(-45)"/><path d="M16,12a4,4,0,1,1-4,4,4.0045,4.0045,0,0,1,4-4m0-2a6,6,0,1,0,6,6,6,6,0,0,0-6-6Z"/></symbol>
<symbol id="asleep" viewBox="0 0 32 32"><path d="M13.5025,5.4136A15.0755,15.0755,0,0,0,25.096,23.6082a11.1134,11.1134,0,0,1-7.9749,3.3893c-.1385,0-.2782.0051-.4178,0A11.0944,11.0944,0,0,1,13.5025,5.4136M14.98,3a1.0024,1.0024,0,0,0-.1746.0156A13.0959,13.0959,0,0,0,16.63,28.9973c.1641.006.3282,0,.4909,0a13.0724,13.0724,0,0,0,10.702-5.5556,1.0094,1.0094,0,0,0-.7833-1.5644A13.08,13.08,0,0,1,15.8892,4.38,1.0149,1.0149,0,0,0,14.98,3Z"/></symbol>
<symbol id="rss" viewBox="0 0 32 32"><path d="M8,18c-3.3,0-6,2.7-6,6s2.7,6,6,6s6-2.7,6-6C14,20.7,11.3,18,8,18z M8,28c-2.2,0-4-1.8-4-4s1.8-4,4-4s4,1.8,4,4C12,26.2,10.2,28,8,28z"/><path d="M30,24h-2C28,13,19,4,8,4V2C20.1,2,30,11.9,30,24z"/><path d="M22,24h-2c0-6.6-5.4-12-12-12v-2C15.7,10,22,16.3,22,24z"/></symbol>
</svg>

    <header id="site-header">
        <div>
            <span class="header-brand"><a href="https://yazeed1s.github.io"><strong><span style="color: var(--accent-hover);">~/</span>Yazeed&#x27;s Blog</strong></a></span>
            <nav>
                <a href="https://yazeed1s.github.io/" >Home</a>
                <a href="https://yazeed1s.github.io/posts/"  class="active" >Posts</a>
                <a href="https://yazeed1s.github.io/projects/" >Projects</a>
                <a href="https://yazeed1s.github.io/tags/" >Tags</a>
                </nav>
            <a href="#" onclick="
                        T();
                        return false;
                    " class="theme" aria-label="Toggle theme" title="Toggle theme">
<svg><use href="#light"/></svg>
<svg><use href="#asleep"/></svg></a>
        </div>
    </header>
    <hr class="site-sep" />
    <main id="main">
<article>
    <header>
        <h1>Using Bit Flags to Pack Multiple States Efficiently</h1>
        <div class="post-meta">
            <time datetime="2025-01-21">21 Jan 2025</time>
            
            <span>A simple way to embed multiple boolean conditions in a single integer.</span>
             
            <span class="post-tags">
                <span class="post-tags-label">Tags: </span>
                
                <a href="https://yazeed1s.github.io/tags/c">C</a><span
                    class="tag-comma">,</span> 
                <a href="https://yazeed1s.github.io/tags/bit-manipulation">Bit Manipulation</a><span
                    class="tag-comma">,</span> 
                <a href="https://yazeed1s.github.io/tags/systems-programming">Systems Programming</a>
            </span>
            
        </div>
    </header>
     <hr />
<p>Sometimes you need to track multiple boolean conditions at once. You could use a bunch of separate <code>bool</code> variables, or an array, or a struct with fields. But there's a cleaner way: pack them all into a single integer using bit flags.</p>
<hr />
<h2 id="the-idea">The Idea</h2>
<p>Each bit in an integer represents one condition. Bit 0 is condition A, bit 1 is condition B, and so on. A 32-bit integer gives you 32 independent flags. You set, clear, and check them using bitwise operators. I personally like to think of it as a list of <code>"light switches"</code> that can be either on or off. In a 32-bit integer, you have 32 light switches, each one represents a different condition and can be either on or off.</p>
<pre class="giallo" style="color-scheme: light dark; color: light-dark(#3C3836, #D3C6AA); background-color: light-dark(#151515, #202020);"><code data-lang="plain"><span class="giallo-l"><span>Bit position:    7   6   5   4   3   2   1   0</span></span>
<span class="giallo-l"><span>               +---+---+---+---+---+---+---+---+</span></span>
<span class="giallo-l"><span>               | 0 | 0 | 0 | 0 | 1 | 1 | 1 | 0 |  = 0x0E (14)</span></span>
<span class="giallo-l"><span>               +---+---+---+---+---+---+---+---+</span></span>
<span class="giallo-l"><span>                                 ^   ^   ^</span></span>
<span class="giallo-l"><span>                                 |   |   +-- FLAG_B (bit 1)</span></span>
<span class="giallo-l"><span>                                 |   +------ FLAG_C (bit 2)</span></span>
<span class="giallo-l"><span>                                 +---------- FLAG_D (bit 3)</span></span></code></pre>
<p>The value <code>0x0E</code> (14 in decimal) means flags B, C, and D are set.</p>
<h2 id="defining-flags">Defining Flags</h2>
<p>Use powers of 2 so each flag occupies exactly one bit:</p>
<pre class="giallo" style="color-scheme: light dark; color: light-dark(#3C3836, #D3C6AA); background-color: light-dark(#151515, #202020);"><code data-lang="c"><span class="giallo-l"><span style="color: light-dark(#685C52, #9C8B7C);">#</span><span style="color: light-dark(#955F3C, #E08F5A);">define</span><span style="color: light-dark(#955F3C, #E08F5A);"> FLAG_A</span><span style="color: light-dark(#685C52, #9C8B7C);">  (</span><span style="color: light-dark(#8C5967, #D3869B);">1</span><span style="color: light-dark(#9C4641, #EA6962);"> &lt;&lt;</span><span style="color: light-dark(#8C5967, #D3869B);"> 0</span><span style="color: light-dark(#685C52, #9C8B7C);">)</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">  /*</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;"> 0x01 = 00000001 </span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">*/</span></span>
<span class="giallo-l"><span style="color: light-dark(#685C52, #9C8B7C);">#</span><span style="color: light-dark(#955F3C, #E08F5A);">define</span><span style="color: light-dark(#955F3C, #E08F5A);"> FLAG_B</span><span style="color: light-dark(#685C52, #9C8B7C);">  (</span><span style="color: light-dark(#8C5967, #D3869B);">1</span><span style="color: light-dark(#9C4641, #EA6962);"> &lt;&lt;</span><span style="color: light-dark(#8C5967, #D3869B);"> 1</span><span style="color: light-dark(#685C52, #9C8B7C);">)</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">  /*</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;"> 0x02 = 00000010 </span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">*/</span></span>
<span class="giallo-l"><span style="color: light-dark(#685C52, #9C8B7C);">#</span><span style="color: light-dark(#955F3C, #E08F5A);">define</span><span style="color: light-dark(#955F3C, #E08F5A);"> FLAG_C</span><span style="color: light-dark(#685C52, #9C8B7C);">  (</span><span style="color: light-dark(#8C5967, #D3869B);">1</span><span style="color: light-dark(#9C4641, #EA6962);"> &lt;&lt;</span><span style="color: light-dark(#8C5967, #D3869B);"> 2</span><span style="color: light-dark(#685C52, #9C8B7C);">)</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">  /*</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;"> 0x04 = 00000100 </span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">*/</span></span>
<span class="giallo-l"><span style="color: light-dark(#685C52, #9C8B7C);">#</span><span style="color: light-dark(#955F3C, #E08F5A);">define</span><span style="color: light-dark(#955F3C, #E08F5A);"> FLAG_D</span><span style="color: light-dark(#685C52, #9C8B7C);">  (</span><span style="color: light-dark(#8C5967, #D3869B);">1</span><span style="color: light-dark(#9C4641, #EA6962);"> &lt;&lt;</span><span style="color: light-dark(#8C5967, #D3869B);"> 3</span><span style="color: light-dark(#685C52, #9C8B7C);">)</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">  /*</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;"> 0x08 = 00001000 </span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">*/</span></span></code></pre>
<p>Or use an enum, which is cleaner:</p>
<pre class="giallo" style="color-scheme: light dark; color: light-dark(#3C3836, #D3C6AA); background-color: light-dark(#151515, #202020);"><code data-lang="c"><span class="giallo-l"><span style="color: light-dark(#9C4641, #EA6962);">typedef</span><span style="color: light-dark(#9C4641, #EA6962);"> enum</span><span style="color: light-dark(#685C52, #9C8B7C);"> {</span></span>
<span class="giallo-l"><span>    FLAG_NONE </span><span style="color: light-dark(#9C4641, #EA6962);">=</span><span style="color: light-dark(#8C5967, #D3869B);"> 0</span><span style="color: light-dark(#685C52, #9C8B7C);">,</span></span>
<span class="giallo-l"><span>    FLAG_A    </span><span style="color: light-dark(#9C4641, #EA6962);">=</span><span style="color: light-dark(#685C52, #9C8B7C);"> (</span><span style="color: light-dark(#8C5967, #D3869B);">1</span><span style="color: light-dark(#9C4641, #EA6962);"> &lt;&lt;</span><span style="color: light-dark(#8C5967, #D3869B);"> 0</span><span style="color: light-dark(#685C52, #9C8B7C);">)</span><span style="color: light-dark(#685C52, #9C8B7C);">,</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">  /*</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;"> bit 0 </span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">*/</span></span>
<span class="giallo-l"><span>    FLAG_B    </span><span style="color: light-dark(#9C4641, #EA6962);">=</span><span style="color: light-dark(#685C52, #9C8B7C);"> (</span><span style="color: light-dark(#8C5967, #D3869B);">1</span><span style="color: light-dark(#9C4641, #EA6962);"> &lt;&lt;</span><span style="color: light-dark(#8C5967, #D3869B);"> 1</span><span style="color: light-dark(#685C52, #9C8B7C);">)</span><span style="color: light-dark(#685C52, #9C8B7C);">,</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">  /*</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;"> bit 1 </span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">*/</span></span>
<span class="giallo-l"><span>    FLAG_C    </span><span style="color: light-dark(#9C4641, #EA6962);">=</span><span style="color: light-dark(#685C52, #9C8B7C);"> (</span><span style="color: light-dark(#8C5967, #D3869B);">1</span><span style="color: light-dark(#9C4641, #EA6962);"> &lt;&lt;</span><span style="color: light-dark(#8C5967, #D3869B);"> 2</span><span style="color: light-dark(#685C52, #9C8B7C);">)</span><span style="color: light-dark(#685C52, #9C8B7C);">,</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">  /*</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;"> bit 2 </span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">*/</span></span>
<span class="giallo-l"><span>    FLAG_D    </span><span style="color: light-dark(#9C4641, #EA6962);">=</span><span style="color: light-dark(#685C52, #9C8B7C);"> (</span><span style="color: light-dark(#8C5967, #D3869B);">1</span><span style="color: light-dark(#9C4641, #EA6962);"> &lt;&lt;</span><span style="color: light-dark(#8C5967, #D3869B);"> 3</span><span style="color: light-dark(#685C52, #9C8B7C);">)</span><span style="color: light-dark(#685C52, #9C8B7C);">,</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">  /*</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;"> bit 3 </span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">*/</span></span>
<span class="giallo-l"><span style="color: light-dark(#685C52, #9C8B7C);">}</span><span style="color: light-dark(#576E65, #83A598);"> flags_t</span><span style="color: light-dark(#685C52, #9C8B7C);">;</span></span></code></pre><h2 id="operations">Operations</h2>
<p><strong>Set a flag:</strong></p>
<pre class="giallo" style="color-scheme: light dark; color: light-dark(#3C3836, #D3C6AA); background-color: light-dark(#151515, #202020);"><code data-lang="c"><span class="giallo-l"><span>flags </span><span style="color: light-dark(#9C4641, #EA6962);">|=</span><span> FLAG_A</span><span style="color: light-dark(#685C52, #9C8B7C);">;</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">  /*</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;"> turn on bit 0 </span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">*/</span></span></code></pre>
<p><strong>Clear a flag:</strong></p>
<pre class="giallo" style="color-scheme: light dark; color: light-dark(#3C3836, #D3C6AA); background-color: light-dark(#151515, #202020);"><code data-lang="c"><span class="giallo-l"><span>flags </span><span style="color: light-dark(#9C4641, #EA6962);">&amp;=</span><span style="color: light-dark(#9C4641, #EA6962);"> ~</span><span>FLAG_A</span><span style="color: light-dark(#685C52, #9C8B7C);">;</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">  /*</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;"> turn off bit 0 </span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">*/</span></span></code></pre>
<p><strong>Toggle a flag:</strong></p>
<pre class="giallo" style="color-scheme: light dark; color: light-dark(#3C3836, #D3C6AA); background-color: light-dark(#151515, #202020);"><code data-lang="c"><span class="giallo-l"><span>flags </span><span style="color: light-dark(#9C4641, #EA6962);">^=</span><span> FLAG_A</span><span style="color: light-dark(#685C52, #9C8B7C);">;</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">  /*</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;"> flip bit 0 </span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">*/</span></span></code></pre>
<p><strong>Check if a flag is set:</strong></p>
<pre class="giallo" style="color-scheme: light dark; color: light-dark(#3C3836, #D3C6AA); background-color: light-dark(#151515, #202020);"><code data-lang="c"><span class="giallo-l"><span style="color: light-dark(#9C4641, #EA6962);">if</span><span style="color: light-dark(#685C52, #9C8B7C);"> (</span><span>flags </span><span style="color: light-dark(#9C4641, #EA6962);">&amp;</span><span> FLAG_A</span><span style="color: light-dark(#685C52, #9C8B7C);">)</span><span style="color: light-dark(#685C52, #9C8B7C);"> {</span></span>
<span class="giallo-l"><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">    /*</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;"> FLAG_A is set </span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">*/</span></span>
<span class="giallo-l"><span style="color: light-dark(#685C52, #9C8B7C);">}</span></span></code></pre>
<p><strong>Check multiple flags:</strong></p>
<pre class="giallo" style="color-scheme: light dark; color: light-dark(#3C3836, #D3C6AA); background-color: light-dark(#151515, #202020);"><code data-lang="c"><span class="giallo-l"><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">/*</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;"> check if ANY of these are set </span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">*/</span></span>
<span class="giallo-l"><span style="color: light-dark(#9C4641, #EA6962);">if</span><span style="color: light-dark(#685C52, #9C8B7C);"> (</span><span>flags </span><span style="color: light-dark(#9C4641, #EA6962);">&amp;</span><span style="color: light-dark(#685C52, #9C8B7C);"> (</span><span>FLAG_A </span><span style="color: light-dark(#9C4641, #EA6962);">|</span><span> FLAG_B</span><span style="color: light-dark(#685C52, #9C8B7C);">)</span><span style="color: light-dark(#685C52, #9C8B7C);">)</span><span style="color: light-dark(#685C52, #9C8B7C);"> {</span><span> ... </span><span style="color: light-dark(#685C52, #9C8B7C);">}</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">/*</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;"> check if ALL of these are set </span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">*/</span></span>
<span class="giallo-l"><span style="color: light-dark(#9C4641, #EA6962);">if</span><span style="color: light-dark(#685C52, #9C8B7C);"> (</span><span style="color: light-dark(#685C52, #9C8B7C);">(</span><span>flags </span><span style="color: light-dark(#9C4641, #EA6962);">&amp;</span><span style="color: light-dark(#685C52, #9C8B7C);"> (</span><span>FLAG_A </span><span style="color: light-dark(#9C4641, #EA6962);">|</span><span> FLAG_B</span><span style="color: light-dark(#685C52, #9C8B7C);">)</span><span style="color: light-dark(#685C52, #9C8B7C);">)</span><span style="color: light-dark(#9C4641, #EA6962);"> ==</span><span style="color: light-dark(#685C52, #9C8B7C);"> (</span><span>FLAG_A </span><span style="color: light-dark(#9C4641, #EA6962);">|</span><span> FLAG_B</span><span style="color: light-dark(#685C52, #9C8B7C);">)</span><span style="color: light-dark(#685C52, #9C8B7C);">)</span><span style="color: light-dark(#685C52, #9C8B7C);"> {</span><span> ... </span><span style="color: light-dark(#685C52, #9C8B7C);">}</span></span></code></pre><h2 id="visualizing-multiple-flag-operations">Visualizing Multiple Flag Operations</h2>
<p>Step by step when you combine flags:</p>
<pre class="giallo" style="color-scheme: light dark; color: light-dark(#3C3836, #D3C6AA); background-color: light-dark(#151515, #202020);"><code data-lang="plain"><span class="giallo-l"><span>Start with empty flags:</span></span>
<span class="giallo-l"><span>flags = 0x00         00000000</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span>Set FLAG_A (bit 0):</span></span>
<span class="giallo-l"><span>flags |= FLAG_A      00000000</span></span>
<span class="giallo-l"><span>                   | 00000001  (FLAG_A)</span></span>
<span class="giallo-l"><span>                   ----------</span></span>
<span class="giallo-l"><span>                     00000001  = 0x01</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span>Set FLAG_C (bit 2):</span></span>
<span class="giallo-l"><span>flags |= FLAG_C      00000001</span></span>
<span class="giallo-l"><span>                   | 00000100  (FLAG_C)</span></span>
<span class="giallo-l"><span>                   ----------</span></span>
<span class="giallo-l"><span>                     00000101  = 0x05</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span>Set FLAG_D (bit 3):</span></span>
<span class="giallo-l"><span>flags |= FLAG_D      00000101</span></span>
<span class="giallo-l"><span>                   | 00001000  (FLAG_D)</span></span>
<span class="giallo-l"><span>                   ----------</span></span>
<span class="giallo-l"><span>                     00001101  = 0x0D</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span>Current state:</span></span>
<span class="giallo-l"><span>+---+---+---+---+---+---+---+---+</span></span>
<span class="giallo-l"><span>| 0 | 0 | 0 | 0 | 1 | 1 | 0 | 1 |  = 0x0D (13)</span></span>
<span class="giallo-l"><span>+---+---+---+---+---+---+---+---+</span></span>
<span class="giallo-l"><span>  7   6   5   4   3   2   1   0</span></span>
<span class="giallo-l"><span>                  D   C       A   &lt;- flags set</span></span></code></pre>
<p>Now let's clear FLAG_C:</p>
<pre class="giallo" style="color-scheme: light dark; color: light-dark(#3C3836, #D3C6AA); background-color: light-dark(#151515, #202020);"><code data-lang="plain"><span class="giallo-l"><span>Clear FLAG_C:</span></span>
<span class="giallo-l"><span>~FLAG_C              11111011  (invert FLAG_C)</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span>flags &amp;= ~FLAG_C     00001101</span></span>
<span class="giallo-l"><span>                   &amp; 11111011</span></span>
<span class="giallo-l"><span>                   ----------</span></span>
<span class="giallo-l"><span>                     00001001  = 0x09</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span>Result:</span></span>
<span class="giallo-l"><span>+---+---+---+---+---+---+---+---+</span></span>
<span class="giallo-l"><span>| 0 | 0 | 0 | 0 | 1 | 0 | 0 | 1 |  = 0x09 (9)</span></span>
<span class="giallo-l"><span>+---+---+---+---+---+---+---+---+</span></span>
<span class="giallo-l"><span>  7   6   5   4   3   2   1   0</span></span>
<span class="giallo-l"><span>                  D           A   ‚Üê flags set (C is gone)</span></span></code></pre><h2 id="real-example-monitor-state-changes">Real Example: Monitor State Changes</h2>
<p>In my window manager, I track what changed when monitors are plugged in or unplugged:</p>
<pre class="giallo" style="color-scheme: light dark; color: light-dark(#3C3836, #D3C6AA); background-color: light-dark(#151515, #202020);"><code data-lang="c"><span class="giallo-l"><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">/*</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;"> bit flags for monitor state changes </span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">*/</span></span>
<span class="giallo-l"><span style="color: light-dark(#9C4641, #EA6962);">typedef</span><span style="color: light-dark(#9C4641, #EA6962);"> enum</span><span style="color: light-dark(#685C52, #9C8B7C);"> {</span></span>
<span class="giallo-l"><span>    _NONE        </span><span style="color: light-dark(#9C4641, #EA6962);">=</span><span style="color: light-dark(#685C52, #9C8B7C);"> (</span><span style="color: light-dark(#8C5967, #D3869B);">1</span><span style="color: light-dark(#9C4641, #EA6962);"> &lt;&lt;</span><span style="color: light-dark(#8C5967, #D3869B);"> 0</span><span style="color: light-dark(#685C52, #9C8B7C);">)</span><span style="color: light-dark(#685C52, #9C8B7C);">,</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">  /*</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;"> 00000001 - no change </span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">*/</span></span>
<span class="giallo-l"><span>    CONNECTED    </span><span style="color: light-dark(#9C4641, #EA6962);">=</span><span style="color: light-dark(#685C52, #9C8B7C);"> (</span><span style="color: light-dark(#8C5967, #D3869B);">1</span><span style="color: light-dark(#9C4641, #EA6962);"> &lt;&lt;</span><span style="color: light-dark(#8C5967, #D3869B);"> 1</span><span style="color: light-dark(#685C52, #9C8B7C);">)</span><span style="color: light-dark(#685C52, #9C8B7C);">,</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">  /*</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;"> 00000010 - monitor connected </span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">*/</span></span>
<span class="giallo-l"><span>    DISCONNECTED </span><span style="color: light-dark(#9C4641, #EA6962);">=</span><span style="color: light-dark(#685C52, #9C8B7C);"> (</span><span style="color: light-dark(#8C5967, #D3869B);">1</span><span style="color: light-dark(#9C4641, #EA6962);"> &lt;&lt;</span><span style="color: light-dark(#8C5967, #D3869B);"> 2</span><span style="color: light-dark(#685C52, #9C8B7C);">)</span><span style="color: light-dark(#685C52, #9C8B7C);">,</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">  /*</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;"> 00000100 - monitor disconnected </span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">*/</span></span>
<span class="giallo-l"><span>    LAYOUT       </span><span style="color: light-dark(#9C4641, #EA6962);">=</span><span style="color: light-dark(#685C52, #9C8B7C);"> (</span><span style="color: light-dark(#8C5967, #D3869B);">1</span><span style="color: light-dark(#9C4641, #EA6962);"> &lt;&lt;</span><span style="color: light-dark(#8C5967, #D3869B);"> 3</span><span style="color: light-dark(#685C52, #9C8B7C);">)</span><span style="color: light-dark(#685C52, #9C8B7C);">,</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">  /*</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;"> 00001000 - resolution/position changed </span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">*/</span></span>
<span class="giallo-l"><span style="color: light-dark(#685C52, #9C8B7C);">}</span><span style="color: light-dark(#576E65, #83A598);"> monitor_state_t</span><span style="color: light-dark(#685C52, #9C8B7C);">;</span></span></code></pre>
<p>When I query the X server for monitor changes, I build up a bitmask:</p>
<pre class="giallo" style="color-scheme: light dark; color: light-dark(#3C3836, #D3C6AA); background-color: light-dark(#151515, #202020);"><code data-lang="c"><span class="giallo-l"><span style="color: light-dark(#9C4641, #EA6962);">void</span><span style="color: light-dark(#707943, #A9B665);"> update_monitors</span><span style="color: light-dark(#685C52, #9C8B7C);">(</span><span style="color: light-dark(#9C4641, #EA6962);">uint32_t</span><span style="color: light-dark(#9C4641, #EA6962);"> *</span><span>changes</span><span style="color: light-dark(#685C52, #9C8B7C);">)</span><span style="color: light-dark(#685C52, #9C8B7C);"> {</span></span>
<span class="giallo-l"><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">    /*</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;"> start with &quot;no change&quot; flag </span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">*/</span></span>
<span class="giallo-l"><span style="color: light-dark(#9C4641, #EA6962);">    *</span><span>changes </span><span style="color: light-dark(#9C4641, #EA6962);">=</span><span> _NONE</span><span style="color: light-dark(#685C52, #9C8B7C);">;</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">    /*</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;"> ... query X server for outputs ... </span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">*/</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: light-dark(#9C4641, #EA6962);">    if</span><span style="color: light-dark(#685C52, #9C8B7C);"> (</span><span>new_monitor_added</span><span style="color: light-dark(#685C52, #9C8B7C);">)</span><span style="color: light-dark(#685C52, #9C8B7C);"> {</span></span>
<span class="giallo-l"><span style="color: light-dark(#9C4641, #EA6962);">        *</span><span>changes </span><span style="color: light-dark(#9C4641, #EA6962);">&amp;=</span><span style="color: light-dark(#9C4641, #EA6962);"> ~</span><span>_NONE</span><span style="color: light-dark(#685C52, #9C8B7C);">;</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">       /*</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;"> clear the &quot;no change&quot; flag </span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">*/</span></span>
<span class="giallo-l"><span style="color: light-dark(#9C4641, #EA6962);">        *</span><span>changes </span><span style="color: light-dark(#9C4641, #EA6962);">|=</span><span> CONNECTED</span><span style="color: light-dark(#685C52, #9C8B7C);">;</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">    /*</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;"> set the &quot;connected&quot; flag </span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">*/</span></span>
<span class="giallo-l"><span style="color: light-dark(#685C52, #9C8B7C);">    }</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: light-dark(#9C4641, #EA6962);">    if</span><span style="color: light-dark(#685C52, #9C8B7C);"> (</span><span>monitor_removed</span><span style="color: light-dark(#685C52, #9C8B7C);">)</span><span style="color: light-dark(#685C52, #9C8B7C);"> {</span></span>
<span class="giallo-l"><span style="color: light-dark(#9C4641, #EA6962);">        *</span><span>changes </span><span style="color: light-dark(#9C4641, #EA6962);">&amp;=</span><span style="color: light-dark(#9C4641, #EA6962);"> ~</span><span>_NONE</span><span style="color: light-dark(#685C52, #9C8B7C);">;</span></span>
<span class="giallo-l"><span style="color: light-dark(#9C4641, #EA6962);">        *</span><span>changes </span><span style="color: light-dark(#9C4641, #EA6962);">|=</span><span> DISCONNECTED</span><span style="color: light-dark(#685C52, #9C8B7C);">;</span></span>
<span class="giallo-l"><span style="color: light-dark(#685C52, #9C8B7C);">    }</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: light-dark(#9C4641, #EA6962);">    if</span><span style="color: light-dark(#685C52, #9C8B7C);"> (</span><span>resolution_changed</span><span style="color: light-dark(#685C52, #9C8B7C);">)</span><span style="color: light-dark(#685C52, #9C8B7C);"> {</span></span>
<span class="giallo-l"><span style="color: light-dark(#9C4641, #EA6962);">        *</span><span>changes </span><span style="color: light-dark(#9C4641, #EA6962);">&amp;=</span><span style="color: light-dark(#9C4641, #EA6962);"> ~</span><span>_NONE</span><span style="color: light-dark(#685C52, #9C8B7C);">;</span></span>
<span class="giallo-l"><span style="color: light-dark(#9C4641, #EA6962);">        *</span><span>changes </span><span style="color: light-dark(#9C4641, #EA6962);">|=</span><span> LAYOUT</span><span style="color: light-dark(#685C52, #9C8B7C);">;</span></span>
<span class="giallo-l"><span style="color: light-dark(#685C52, #9C8B7C);">    }</span></span>
<span class="giallo-l"><span style="color: light-dark(#685C52, #9C8B7C);">}</span></span></code></pre>
<p>Imagine a scenario: you plug in a new monitor AND that monitor has a different resolution than expected. Both events happen:</p>
<pre class="giallo" style="color-scheme: light dark; color: light-dark(#3C3836, #D3C6AA); background-color: light-dark(#151515, #202020);"><code data-lang="plain"><span class="giallo-l"><span>Start:               00000001  (_NONE)</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span>New monitor detected:</span></span>
<span class="giallo-l"><span>  clear _NONE        &amp;= ~00000001  -&gt; 00000000</span></span>
<span class="giallo-l"><span>  set CONNECTED      |=  00000010  -&gt; 00000010</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span>Resolution differs:</span></span>
<span class="giallo-l"><span>  set LAYOUT         |=  00001000  -&gt; 00001010</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span>Final value:</span></span>
<span class="giallo-l"><span>+---+---+---+---+---+---+---+---+</span></span>
<span class="giallo-l"><span>| 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 |  = 0x0A (10)</span></span>
<span class="giallo-l"><span>+---+---+---+---+---+---+---+---+</span></span>
<span class="giallo-l"><span>                  L       C</span></span>
<span class="giallo-l"><span>                  A       O</span></span>
<span class="giallo-l"><span>                  Y       N</span></span>
<span class="giallo-l"><span>                  O       N</span></span>
<span class="giallo-l"><span>                  U       E</span></span>
<span class="giallo-l"><span>                  T       C</span></span>
<span class="giallo-l"><span>                          T</span></span>
<span class="giallo-l"><span>                          E</span></span>
<span class="giallo-l"><span>                          D</span></span></code></pre>
<p>Now I can handle both events:</p>
<pre class="giallo" style="color-scheme: light dark; color: light-dark(#3C3836, #D3C6AA); background-color: light-dark(#151515, #202020);"><code data-lang="c"><span class="giallo-l"><span style="color: light-dark(#9C4641, #EA6962);">void</span><span style="color: light-dark(#707943, #A9B665);"> handle_monitor_changes</span><span style="color: light-dark(#685C52, #9C8B7C);">(</span><span style="color: light-dark(#9C4641, #EA6962);">void</span><span style="color: light-dark(#685C52, #9C8B7C);">)</span><span style="color: light-dark(#685C52, #9C8B7C);"> {</span></span>
<span class="giallo-l"><span style="color: light-dark(#9C4641, #EA6962);">    uint32_t</span><span> m_change </span><span style="color: light-dark(#9C4641, #EA6962);">=</span><span> _NONE</span><span style="color: light-dark(#685C52, #9C8B7C);">;</span></span>
<span class="giallo-l"><span style="color: light-dark(#707943, #A9B665);">    update_monitors</span><span style="color: light-dark(#685C52, #9C8B7C);">(</span><span style="color: light-dark(#9C4641, #EA6962);">&amp;</span><span>m_change</span><span style="color: light-dark(#685C52, #9C8B7C);">)</span><span style="color: light-dark(#685C52, #9C8B7C);">;</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: light-dark(#9C4641, #EA6962);">    if</span><span style="color: light-dark(#685C52, #9C8B7C);"> (</span><span>m_change </span><span style="color: light-dark(#9C4641, #EA6962);">&amp;</span><span> _NONE</span><span style="color: light-dark(#685C52, #9C8B7C);">)</span><span style="color: light-dark(#685C52, #9C8B7C);"> {</span></span>
<span class="giallo-l"><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">        /*</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;"> nothing changed </span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">*/</span></span>
<span class="giallo-l"><span style="color: light-dark(#9C4641, #EA6962);">        return</span><span style="color: light-dark(#685C52, #9C8B7C);">;</span></span>
<span class="giallo-l"><span style="color: light-dark(#685C52, #9C8B7C);">    }</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: light-dark(#9C4641, #EA6962);">    if</span><span style="color: light-dark(#685C52, #9C8B7C);"> (</span><span>m_change </span><span style="color: light-dark(#9C4641, #EA6962);">&amp;</span><span> CONNECTED</span><span style="color: light-dark(#685C52, #9C8B7C);">)</span><span style="color: light-dark(#685C52, #9C8B7C);"> {</span></span>
<span class="giallo-l"><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">        /*</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;"> handle new monitor </span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">*/</span></span>
<span class="giallo-l"><span style="color: light-dark(#685C52, #9C8B7C);">    }</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: light-dark(#9C4641, #EA6962);">    if</span><span style="color: light-dark(#685C52, #9C8B7C);"> (</span><span>m_change </span><span style="color: light-dark(#9C4641, #EA6962);">&amp;</span><span> DISCONNECTED</span><span style="color: light-dark(#685C52, #9C8B7C);">)</span><span style="color: light-dark(#685C52, #9C8B7C);"> {</span></span>
<span class="giallo-l"><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">        /*</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;"> handle removed monitor </span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">*/</span></span>
<span class="giallo-l"><span style="color: light-dark(#685C52, #9C8B7C);">    }</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: light-dark(#9C4641, #EA6962);">    if</span><span style="color: light-dark(#685C52, #9C8B7C);"> (</span><span>m_change </span><span style="color: light-dark(#9C4641, #EA6962);">&amp;</span><span> LAYOUT</span><span style="color: light-dark(#685C52, #9C8B7C);">)</span><span style="color: light-dark(#685C52, #9C8B7C);"> {</span></span>
<span class="giallo-l"><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">        /*</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;"> handle resolution change </span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">*/</span></span>
<span class="giallo-l"><span style="color: light-dark(#685C52, #9C8B7C);">    }</span></span>
<span class="giallo-l"><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">    /*</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;"> ... handle other events ... </span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">*/</span></span>
<span class="giallo-l"><span style="color: light-dark(#685C52, #9C8B7C);">}</span></span></code></pre>
<p>With a single integer, I can track and respond to any combination of events.</p>
<h2 id="validation-example-red-black-tree">Validation Example: Red-Black Tree</h2>
<p>A while back I implemented a red-black tree. To validate the tree invariants, I used bit flags to track which rules were violated:</p>
<pre class="giallo" style="color-scheme: light dark; color: light-dark(#3C3836, #D3C6AA); background-color: light-dark(#151515, #202020);"><code data-lang="c"><span class="giallo-l"><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">/*</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;"> Red-black tree rules:</span></span>
<span class="giallo-l"><span style="color: light-dark(#928374, #7C6F64);font-style: italic;"> * 1- Every node is either red or black.</span></span>
<span class="giallo-l"><span style="color: light-dark(#928374, #7C6F64);font-style: italic;"> * 2- Root is always black.</span></span>
<span class="giallo-l"><span style="color: light-dark(#928374, #7C6F64);font-style: italic;"> * 3- Every leaf (NULL) is black.</span></span>
<span class="giallo-l"><span style="color: light-dark(#928374, #7C6F64);font-style: italic;"> * 4- If a node is red, both its children are black.</span></span>
<span class="giallo-l"><span style="color: light-dark(#928374, #7C6F64);font-style: italic;"> * 5- Every path from root to leaf has the same number of black nodes.</span></span>
<span class="giallo-l"><span style="color: light-dark(#928374, #7C6F64);font-style: italic;"> */</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: light-dark(#9C4641, #EA6962);">typedef</span><span style="color: light-dark(#9C4641, #EA6962);"> enum</span><span style="color: light-dark(#685C52, #9C8B7C);"> {</span></span>
<span class="giallo-l"><span>    RB_VALID               </span><span style="color: light-dark(#9C4641, #EA6962);">=</span><span style="color: light-dark(#9C4641, #EA6962);"> 0x</span><span style="color: light-dark(#8C5967, #D3869B);">00</span><span style="color: light-dark(#685C52, #9C8B7C);">,</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">  /*</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;"> 00000000 - no violations </span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">*/</span></span>
<span class="giallo-l"><span>    RB_INVALID_COLOR       </span><span style="color: light-dark(#9C4641, #EA6962);">=</span><span style="color: light-dark(#9C4641, #EA6962);"> 0x</span><span style="color: light-dark(#8C5967, #D3869B);">01</span><span style="color: light-dark(#685C52, #9C8B7C);">,</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">  /*</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;"> 00000001 - rule 1 broken </span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">*/</span></span>
<span class="giallo-l"><span>    RB_RED_ROOT            </span><span style="color: light-dark(#9C4641, #EA6962);">=</span><span style="color: light-dark(#9C4641, #EA6962);"> 0x</span><span style="color: light-dark(#8C5967, #D3869B);">02</span><span style="color: light-dark(#685C52, #9C8B7C);">,</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">  /*</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;"> 00000010 - rule 2 broken </span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">*/</span></span>
<span class="giallo-l"><span>    RB_NULL_NOT_BLACK      </span><span style="color: light-dark(#9C4641, #EA6962);">=</span><span style="color: light-dark(#9C4641, #EA6962);"> 0x</span><span style="color: light-dark(#8C5967, #D3869B);">04</span><span style="color: light-dark(#685C52, #9C8B7C);">,</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">  /*</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;"> 00000100 - rule 3 broken </span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">*/</span></span>
<span class="giallo-l"><span>    RB_RED_CHILD_OF_RED    </span><span style="color: light-dark(#9C4641, #EA6962);">=</span><span style="color: light-dark(#9C4641, #EA6962);"> 0x</span><span style="color: light-dark(#8C5967, #D3869B);">08</span><span style="color: light-dark(#685C52, #9C8B7C);">,</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">  /*</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;"> 00001000 - rule 4 broken </span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">*/</span></span>
<span class="giallo-l"><span>    RB_UNEQUAL_BLACK_PATHS </span><span style="color: light-dark(#9C4641, #EA6962);">=</span><span style="color: light-dark(#9C4641, #EA6962);"> 0x</span><span style="color: light-dark(#8C5967, #D3869B);">10</span><span style="color: light-dark(#685C52, #9C8B7C);">,</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">  /*</span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;"> 00010000 - rule 5 broken </span><span style="color: light-dark(#928374, #7C6F64);font-style: italic;">*/</span></span>
<span class="giallo-l"><span style="color: light-dark(#685C52, #9C8B7C);">}</span><span style="color: light-dark(#576E65, #83A598);"> rb_violation_t</span><span style="color: light-dark(#685C52, #9C8B7C);">;</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: light-dark(#9C4641, #EA6962);">typedef</span><span style="color: light-dark(#9C4641, #EA6962);"> uint32_t</span><span style="color: light-dark(#576E65, #83A598);"> rb_validation_t</span><span style="color: light-dark(#685C52, #9C8B7C);">;</span></span></code></pre>
<p>The validation function returns all violations at once:</p>
<pre class="giallo" style="color-scheme: light dark; color: light-dark(#3C3836, #D3C6AA); background-color: light-dark(#151515, #202020);"><code data-lang="c"><span class="giallo-l"><span style="color: light-dark(#576E65, #83A598);">rb_validation_t</span><span style="color: light-dark(#707943, #A9B665);"> validate_rbtree</span><span style="color: light-dark(#685C52, #9C8B7C);">(</span><span style="color: light-dark(#576E65, #83A598);">node_t</span><span style="color: light-dark(#9C4641, #EA6962);"> *</span><span>root</span><span style="color: light-dark(#685C52, #9C8B7C);">)</span><span style="color: light-dark(#685C52, #9C8B7C);"> {</span></span>
<span class="giallo-l"><span style="color: light-dark(#576E65, #83A598);">    rb_validation_t</span><span> result </span><span style="color: light-dark(#9C4641, #EA6962);">=</span><span> RB_VALID</span><span style="color: light-dark(#685C52, #9C8B7C);">;</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: light-dark(#9C4641, #EA6962);">    if</span><span style="color: light-dark(#685C52, #9C8B7C);"> (</span><span>root</span><span style="color: light-dark(#685C52, #9C8B7C);">-&gt;</span><span>color</span><span style="color: light-dark(#9C4641, #EA6962);"> ==</span><span> RED</span><span style="color: light-dark(#685C52, #9C8B7C);">)</span><span style="color: light-dark(#685C52, #9C8B7C);"> {</span></span>
<span class="giallo-l"><span>        result </span><span style="color: light-dark(#9C4641, #EA6962);">|=</span><span> RB_RED_ROOT</span><span style="color: light-dark(#685C52, #9C8B7C);">;</span></span>
<span class="giallo-l"><span style="color: light-dark(#685C52, #9C8B7C);">    }</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: light-dark(#9C4641, #EA6962);">    if</span><span style="color: light-dark(#685C52, #9C8B7C);"> (</span><span style="color: light-dark(#707943, #A9B665);">has_red_child_of_red</span><span style="color: light-dark(#685C52, #9C8B7C);">(</span><span>root</span><span style="color: light-dark(#685C52, #9C8B7C);">)</span><span style="color: light-dark(#685C52, #9C8B7C);">)</span><span style="color: light-dark(#685C52, #9C8B7C);"> {</span></span>
<span class="giallo-l"><span>        result </span><span style="color: light-dark(#9C4641, #EA6962);">|=</span><span> RB_RED_CHILD_OF_RED</span><span style="color: light-dark(#685C52, #9C8B7C);">;</span></span>
<span class="giallo-l"><span style="color: light-dark(#685C52, #9C8B7C);">    }</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: light-dark(#9C4641, #EA6962);">    if</span><span style="color: light-dark(#685C52, #9C8B7C);"> (</span><span style="color: light-dark(#9C4641, #EA6962);">!</span><span style="color: light-dark(#707943, #A9B665);">paths_have_equal_black_count</span><span style="color: light-dark(#685C52, #9C8B7C);">(</span><span>root</span><span style="color: light-dark(#685C52, #9C8B7C);">)</span><span style="color: light-dark(#685C52, #9C8B7C);">)</span><span style="color: light-dark(#685C52, #9C8B7C);"> {</span></span>
<span class="giallo-l"><span>        result </span><span style="color: light-dark(#9C4641, #EA6962);">|=</span><span> RB_UNEQUAL_BLACK_PATHS</span><span style="color: light-dark(#685C52, #9C8B7C);">;</span></span>
<span class="giallo-l"><span style="color: light-dark(#685C52, #9C8B7C);">    }</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: light-dark(#9C4641, #EA6962);">    return</span><span> result</span><span style="color: light-dark(#685C52, #9C8B7C);">;</span></span>
<span class="giallo-l"><span style="color: light-dark(#685C52, #9C8B7C);">}</span></span></code></pre>
<p>Say the tree has a red root AND a red node with a red child. The result looks like:</p>
<pre class="giallo" style="color-scheme: light dark; color: light-dark(#3C3836, #D3C6AA); background-color: light-dark(#151515, #202020);"><code data-lang="plain"><span class="giallo-l"><span>RB_RED_ROOT         = 0x02 = 00000010</span></span>
<span class="giallo-l"><span>RB_RED_CHILD_OF_RED = 0x08 = 00001000</span></span>
<span class="giallo-l"><span>                           ----------</span></span>
<span class="giallo-l"><span>Combined (OR)       = 0x0A = 00001010</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span>+---+---+---+---+---+---+---+---+</span></span>
<span class="giallo-l"><span>| 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 |  = 0x0A (10)</span></span>
<span class="giallo-l"><span>+---+---+---+---+---+---+---+---+</span></span>
<span class="giallo-l"><span>  7   6   5   4   3   2   1   0</span></span>
<span class="giallo-l"><span>                  ^       ^</span></span>
<span class="giallo-l"><span>                  |       +-- RB_RED_ROOT (rule 2)</span></span>
<span class="giallo-l"><span>                  +---------- RB_RED_CHILD_OF_RED (rule 4)</span></span></code></pre>
<p>Then you can check what's wrong:</p>
<pre class="giallo" style="color-scheme: light dark; color: light-dark(#3C3836, #D3C6AA); background-color: light-dark(#151515, #202020);"><code data-lang="c"><span class="giallo-l"><span style="color: light-dark(#576E65, #83A598);">rb_validation_t</span><span> v </span><span style="color: light-dark(#9C4641, #EA6962);">=</span><span style="color: light-dark(#707943, #A9B665);"> validate_rbtree</span><span style="color: light-dark(#685C52, #9C8B7C);">(</span><span>tree</span><span style="color: light-dark(#685C52, #9C8B7C);">)</span><span style="color: light-dark(#685C52, #9C8B7C);">;</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: light-dark(#9C4641, #EA6962);">if</span><span style="color: light-dark(#685C52, #9C8B7C);"> (</span><span>v </span><span style="color: light-dark(#9C4641, #EA6962);">==</span><span> RB_VALID</span><span style="color: light-dark(#685C52, #9C8B7C);">)</span><span style="color: light-dark(#685C52, #9C8B7C);"> {</span></span>
<span class="giallo-l"><span style="color: light-dark(#707943, #A9B665);">    printf</span><span style="color: light-dark(#685C52, #9C8B7C);">(</span><span style="color: light-dark(#685C52, #9C8B7C);">&quot;</span><span style="color: light-dark(#906E3A, #D8A657);">tree is valid</span><span style="color: light-dark(#8C5967, #D3869B);">\n</span><span style="color: light-dark(#685C52, #9C8B7C);">&quot;</span><span style="color: light-dark(#685C52, #9C8B7C);">)</span><span style="color: light-dark(#685C52, #9C8B7C);">;</span></span>
<span class="giallo-l"><span style="color: light-dark(#685C52, #9C8B7C);">}</span><span style="color: light-dark(#9C4641, #EA6962);"> else</span><span style="color: light-dark(#685C52, #9C8B7C);"> {</span></span>
<span class="giallo-l"><span style="color: light-dark(#9C4641, #EA6962);">    if</span><span style="color: light-dark(#685C52, #9C8B7C);"> (</span><span>v </span><span style="color: light-dark(#9C4641, #EA6962);">&amp;</span><span> RB_RED_ROOT</span><span style="color: light-dark(#685C52, #9C8B7C);">)</span></span>
<span class="giallo-l"><span style="color: light-dark(#707943, #A9B665);">        printf</span><span style="color: light-dark(#685C52, #9C8B7C);">(</span><span style="color: light-dark(#685C52, #9C8B7C);">&quot;</span><span style="color: light-dark(#906E3A, #D8A657);">violation: root is red</span><span style="color: light-dark(#8C5967, #D3869B);">\n</span><span style="color: light-dark(#685C52, #9C8B7C);">&quot;</span><span style="color: light-dark(#685C52, #9C8B7C);">)</span><span style="color: light-dark(#685C52, #9C8B7C);">;</span></span>
<span class="giallo-l"><span style="color: light-dark(#9C4641, #EA6962);">    if</span><span style="color: light-dark(#685C52, #9C8B7C);"> (</span><span>v </span><span style="color: light-dark(#9C4641, #EA6962);">&amp;</span><span> RB_RED_CHILD_OF_RED</span><span style="color: light-dark(#685C52, #9C8B7C);">)</span></span>
<span class="giallo-l"><span style="color: light-dark(#707943, #A9B665);">        printf</span><span style="color: light-dark(#685C52, #9C8B7C);">(</span><span style="color: light-dark(#685C52, #9C8B7C);">&quot;</span><span style="color: light-dark(#906E3A, #D8A657);">violation: red node has red child</span><span style="color: light-dark(#8C5967, #D3869B);">\n</span><span style="color: light-dark(#685C52, #9C8B7C);">&quot;</span><span style="color: light-dark(#685C52, #9C8B7C);">)</span><span style="color: light-dark(#685C52, #9C8B7C);">;</span></span>
<span class="giallo-l"><span style="color: light-dark(#9C4641, #EA6962);">    if</span><span style="color: light-dark(#685C52, #9C8B7C);"> (</span><span>v </span><span style="color: light-dark(#9C4641, #EA6962);">&amp;</span><span> RB_UNEQUAL_BLACK_PATHS</span><span style="color: light-dark(#685C52, #9C8B7C);">)</span></span>
<span class="giallo-l"><span style="color: light-dark(#707943, #A9B665);">        printf</span><span style="color: light-dark(#685C52, #9C8B7C);">(</span><span style="color: light-dark(#685C52, #9C8B7C);">&quot;</span><span style="color: light-dark(#906E3A, #D8A657);">Violation: unequal black paths</span><span style="color: light-dark(#8C5967, #D3869B);">\n</span><span style="color: light-dark(#685C52, #9C8B7C);">&quot;</span><span style="color: light-dark(#685C52, #9C8B7C);">)</span><span style="color: light-dark(#685C52, #9C8B7C);">;</span></span>
<span class="giallo-l"><span style="color: light-dark(#685C52, #9C8B7C);">}</span></span></code></pre>
<p>This is way cleaner than returning an array of error codes or having separate boolean fields for each violation.</p>
<h2 id="why-use-bit-flags">Why Use Bit Flags?</h2>
<ol>
<li><strong>Memory efficient</strong> - One integer holds 32 (or 64) flags instead of 32 separate bools</li>
<li><strong>Fast</strong> - Bitwise operations are single CPU instructions</li>
<li><strong>Convenient</strong> - Test multiple conditions with one comparison</li>
<li><strong>Combinable</strong> - Easy to pass around, store, and combine multiple states</li>
</ol>
<p>The main downside is readability - <code>flags &amp; FLAG_A</code> isn't as obvious as <code>flags.a</code> at first glance. But once you're used to the pattern, it's fine.</p>
<h2 id="summary">Summary</h2>
<ul>
<li>Each flag is a power of 2: <code>(1 &lt;&lt; n)</code></li>
<li>Set with <code>|=</code>, clear with <code>&amp;= ~</code>, check with <code>&amp;</code></li>
<li>Good for tracking multiple boolean conditions in one value</li>
<li>Common in systems programming, graphics, protocols, and anywhere you need compact state representation</li>
</ul>
  
</article>
</main>
    <hr class="site-sep bottom-sep" />
    <footer class="s">
        
    </footer>
    
    <script>
        document.querySelectorAll("article img[srcset]").forEach((i) => {
            if (i.closest("a")) return;
            i.style.cursor = "pointer";
            i.onclick = () => {
                let d = document.createElement("div"),
                    s = i.srcset.split(",").pop().trim().split(" ")[0];
                d.className = "lb";
                d.innerHTML = '<img src="' + s + '">';
                document.body.style.overflow = "hidden";
                d.onclick = () => {
                    d.remove();
                    document.body.style.overflow = "";
                };
                document.body.appendChild(d);
            };
        });
    </script>
    </body>

</html>