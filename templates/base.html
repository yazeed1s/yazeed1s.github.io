{% import "macros/head.html" as head -%} {% import "macros/opengraph.html" as
social -%} {% import "macros/hooks.html" as hooks -%} {% import
"macros/images.html" as images -%} {% import "macros/icons.html" as icons -%}
<!doctype html>
<html lang="en">

<head>
    {%- block general_meta -%} {{ head::general_meta() }} {%- endblock
    general_meta -%} {%- block og_preview -%} {{ social::og_preview() }} {%-
    endblock og_preview -%} {% if config.extra.favicon %}
    <link rel="icon" href="{{ config.extra.favicon }}" />
    {% endif %}
    <link rel="stylesheet" href="{{ get_url(path='font.css', trailing_slash=false) }}" />
    {% set nav_count = config.extra.menu_links | length -%} {% if nav_count
    >= 6 -%} {% set_global items_per_row = ((nav_count + 1) / 2) | round -%}
    {% else -%} {% set_global items_per_row = nav_count -%} {% endif -%} {%
    set basis = (100 / items_per_row) | round -%}

    <link rel="stylesheet" href="{{ get_url(path='css/base.css', trailing_slash=false) }}" />

    {# Colour configuration with defaults #} {% set light_bg =
    config.extra.colours.light.background | default(value="#FAF7F2") %} {%
    set light_text = config.extra.colours.light.text |
    default(value="#1a1a1a") %} {% set light_text_muted =
    config.extra.colours.light.text_muted | default(value="#3a3a3a") %} {%
    set light_accent = config.extra.colours.light.accent |
    default(value="#B85450") %} {% set light_accent_hover =
    config.extra.colours.light.accent_hover | default(value="#7A3533") %} {%
    set light_code_bg = config.extra.colours.light.code_bg |
    default(value="#f0ebe3") %} {% set light_border =
    config.extra.colours.light.border | default(value="#e0d9ce") %}
    {% set light_bold = config.extra.colours.light.bold | default(value=light_text) %}
    {% set light_italic = config.extra.colours.light.italic | default(value=light_text) %}
    {% set light_headers = config.extra.colours.light.headers | default(value=light_text) %}

    {% set
    dark_bg = config.extra.colours.dark.background |
    default(value="#141413") %} {% set dark_text =
    config.extra.colours.dark.text | default(value="#e8e8e8") %} {% set
    dark_text_muted = config.extra.colours.dark.text_muted |
    default(value="#a0a0a0") %} {% set dark_accent =
    config.extra.colours.dark.accent | default(value="#E07A5F") %} {% set
    dark_accent_hover = config.extra.colours.dark.accent_hover |
    default(value="#F4A594") %} {% set dark_code_bg =
    config.extra.colours.dark.code_bg | default(value="#1e1e1d") %} {% set
    dark_border = config.extra.colours.dark.border |
    default(value="#2a2a29") %}
    {% set dark_bold = config.extra.colours.dark.bold | default(value=dark_text) %}
    {% set dark_italic = config.extra.colours.dark.italic | default(value=dark_text) %}
    {% set dark_headers = config.extra.colours.dark.headers | default(value=dark_text) %}
    <style>
        :root {
            --nav-basis: {{basis}}%;
            --light-bg: {{light_bg}};
            --light-text: {{light_text}};
            --light-text-muted: {{light_text_muted}};
            --light-accent: {{light_accent}};
            --light-accent-hover: {{light_accent_hover}};
            --light-code-bg: {{light_code_bg}};
            --light-border: {{light_border}};
            --light-bold: {{light_bold}};
            --light-italic: {{light_italic}};
            --light-headers: {{light_headers}};
            --dark-bg: {{dark_bg}};
            --dark-text: {{dark_text}};
            --dark-text-muted: {{dark_text_muted}};
            --dark-accent: {{dark_accent}};
            --dark-accent-hover: {{dark_accent_hover}};
            --dark-code-bg: {{dark_code_bg}};
            --dark-border: {{dark_border}};
            --dark-bold: {{dark_bold}};
            --dark-italic: {{dark_italic}};
            --dark-headers: {{dark_headers}};
        }
    </style>
    <meta name="theme-color" id="tc" />
    <script>
        (function () {
            var m = matchMedia("(prefers-color-scheme:dark)"),
                t = localStorage.theme || (m.matches ? "dark" : "light"),
                h = document.documentElement,
                c = document.getElementById("tc");
            h.className = t;
            function u() {
                c.content = getComputedStyle(h).getPropertyValue("--tc");
            }
            u();
            window.T = function () {
                t = t === "dark" ? "light" : "dark";
                localStorage.theme = t;
                h.className = t;
                u();
            };
        })();
    </script>
    {% block head_extra %}{% endblock head_extra %}
</head>

<body>
    <a href="#main" class="skip-link">Skip to content</a>
    {% if config.extra.inline_icons %}{{ icons::sprite() }}{% endif %}
    <header id="site-header">
        <div>
            <span class="header-brand">{% if config.extra.site_icon is defined %}{% if
                config.extra.site_icon == "" or config.extra.site_icon ==
                "quill.svg" %}<svg class="site-icon" viewBox="-116.42 -116.42 596.66 596.66"
                    xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                    <defs>
                        <mask id="m">
                            <rect x="-116.42" y="-116.42" width="596.66" height="596.66" fill="white" />
                            <path fill="black"
                                transform="translate(181.91,181.91) scale(1.25) translate(-181.91,-181.91)"
                                d="M358.872,0.841c-3.196-1.538-7.014-0.931-9.572,1.526c-19.515,18.728-53.141,46.415-102.511,71.961c-2.159,1.118-3.737,3.106-4.333,5.463c-4.028,15.908-11.933,33.271-23.492,51.607l-4.705,7.462l8.772-38.205c0.715-3.115-0.378-6.368-2.828-8.42c-2.451-2.052-5.846-2.556-8.786-1.303l-1.015,0.428C110.79,133.291,81.352,198.24,72.67,233.22c-3.013,12.141-4.516,24.163-4.465,35.738c0.02,4.466,0.272,8.722,0.75,12.705l-66.39,67.703c-3.211,3.273-3.246,8.505-0.078,11.822c1.667,1.745,3.904,2.629,6.149,2.629c2.02,0,4.045-0.717,5.664-2.164l182.428-163.851c0.896,0.059-103.874,109.806-102.925,109.806c14.22,0,33.863-6.555,56.804-18.95c30.935-16.717,65.508-42.37,99.979-74.185c2.832-2.612,3.551-6.805,1.753-10.213c-1.798-3.407-5.662-5.181-9.42-4.315l-21.363,4.904l7.465-4.706c20.835-13.136,40.313-21.511,57.891-24.897c1.901-0.367,3.622-1.372,4.875-2.849c41.348-48.75,58.853-96.919,66.256-128.743c2.69-11.567,4.579-23.134,5.607-34.38C363.972,5.742,362.069,2.379,358.872,0.841z" />
                        </mask>
                    </defs>
                    <rect x="-116.42" y="-116.42" width="596.66" height="596.66" rx="298.33" fill="currentColor"
                        mask="url(#m)" />
                </svg>{% else %}<img src="{{ config.extra.site_icon }}" class="custom-icon" alt="" />{% endif %}{% endif
                %}<a href="{{ config.base_url | safe }}"><strong><span style="color: var(--accent-hover);">~/</span>{{
                        config.title }}</strong></a>{% if
                config.extra.strapline %}<span class="desc">
                    Â· {{ config.extra.strapline }}</span>{% endif %}</span>
            <nav>
                {% for menu_link in config.extra.menu_links -%} {% set link_url
                = menu_link.url | replace(from="$BASE_URL", to=config.base_url)
                -%} {% set current_url_slash = current_url ~ "/" -%} {% set
                base_url_slash = config.base_url ~ "/" -%} {% set is_home =
                link_url == config.base_url or link_url == base_url_slash -%} {%
                set is_active = current_url == link_url or current_url_slash ==
                link_url or (not is_home and current_url is
                starting_with(link_url)) -%}
                <a href="{{ link_url | safe}}" {% if current_url and is_active %} class="active" {% endif
                    %}>{{menu_link.name}}</a>
                {% endfor -%}
            </nav>
            <a href="#" onclick="
                        T();
                        return false;
                    " class="theme" aria-label="Toggle theme" title="Toggle theme">{% if config.extra.inline_icons %}{{
                icons::icon(name="light.svg") }}{{
                icons::icon(name="asleep.svg") }}{% else %}<img src="/icons/light.svg" alt="Light mode" /><img
                    src="/icons/asleep.svg" alt="Dark mode" />{% endif
                %}</a>
        </div>
    </header>
    <hr class="site-sep" />
    <main id="main">{% block content -%} {% endblock -%}</main>
    <hr class="site-sep bottom-sep" />
    <footer class="s">
        {% if config.extra.footer_text %}<span>{{ config.extra.footer_text | safe }}</span>{% endif %}
    </footer>
    {% block body_end -%} {# Lightbox #}
    <script>
        document.querySelectorAll("article img[srcset]").forEach((i) => {
            if (i.closest("a")) return;
            i.style.cursor = "pointer";
            i.onclick = () => {
                let d = document.createElement("div"),
                    s = i.srcset.split(",").pop().trim().split(" ")[0];
                d.className = "lb";
                d.innerHTML = '<img src="' + s + '">';
                document.body.style.overflow = "hidden";
                d.onclick = () => {
                    d.remove();
                    document.body.style.overflow = "";
                };
                document.body.appendChild(d);
            };
        });
    </script>
    {% endblock body_end -%}
</body>

</html>